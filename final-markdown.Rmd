---
title: "Final Markdown"
author: "George Pentchev"
date: "21/06/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(readxl)
library(plotly)
```

```{r enrollment-plot}
raw_data <- read_xlsx("mdc_enrol_1819_en_supp.xlsx")

clean_data <- raw_data %>% 
  mutate(Grade = factor(Grade, levels = c("Grade 9",
                                          "Grade 10",
                                          "Grade 11",
                                          "Grade 12")),
         Enrolment = as.double(Enrolment),
         `Pathway or Destination` = as.factor(`Pathway or Destination`)) %>% 
  drop_na(Grade)

clean_data %>% 
  group_by(Grade) %>% 
  arrange(desc(Enrolment)) %>% 
  slice(1:20) %>% 
  ggplot(aes(x = fct_reorder(as.factor(`Course Code`), desc(Enrolment)),
             y = Enrolment,
             fill = `Pathway or Destination`,
             text = paste("Course Code:", `Course Code`, "\n",
                          "Course Description:", `Course Description`, "\n",
                          "# of Students Enrolled:", Enrolment, "\n",
                          "Pathway/Destination:", `Pathway or Destination`))) +
  geom_col() +
  facet_wrap(~ Grade, scales = "free") +
  scale_y_continuous(labels = scales::comma_format()) +
  scale_x_discrete(labels = NULL, breaks = NULL, name = NULL) +
  ylim(0, 150000) +
  labs(title = "Secondary School Courses vs. Number of Students Enrolled",
       x = "")
```

